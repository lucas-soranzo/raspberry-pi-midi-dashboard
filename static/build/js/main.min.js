!function(e){const t=(t,o,a)=>e.ajax({url:"/command",data:{status_byte:t,data_byte1:o,data_byte2:a},success:e=>getToast({text:Object.values(e).join(" ")})});e.fn.midiCommand=function(e){let o={byte1:204,byte2:0,byte3:0,name:"New Command",icon:null,color:"light",size:"lg",style:"outline",type:"button"};Object.assign(o,e),o.icon=o.icon.toLocaleLowerCase(),o.style=o.style.toLocaleLowerCase(),o.color=o.color.toLocaleLowerCase(),o.type=o.type.toLocaleLowerCase();let a="",n=[];return"button"===o.type?(a=o.icon?`<i class="fas fa-${o.icon}"></i>${a}`:o.name,n=[...n,"btn",`btn${o.style&&"Solid"!=o.style?"-"+o.style:""}-${o.color}`,`btn${o.size?"-"+o.size:""}`,"mr-3"],this.on("click",e=>t(o.byte1,o.byte2,o.byte3))):"slider"===o.type&&(n=[...n,`outline-${o.color}`],this.on("input",e=>t(o.byte1,o.byte2,Number(parseInt(e.target.value/100*127)).toString(16))),this.on("dblclick",e=>{e.preventDefault(),e.target.value=71.653543307,t(o.byte1,o.byte2,"5b")})),this.addClass(n.join(" ")),this.html(a),this}}(jQuery);const Commands=new class{constructor(){this.stored=[],this.load()}createElement(e){let t=$("<command>",{class:`command-container outline-${e.color.toLocaleLowerCase()}`});"button"===e.type.toLocaleLowerCase()?t=$("<button>").midiCommand(e):"slider"===e.type.toLocaleLowerCase()&&(t.append($("<input>",{type:"range",name:"slider",orient:"vertical"}).midiCommand(e)),t.append($("<span>",{class:"command-name"}).html(e.name))),t.appendTo("#commandContainer")}push(e){this.stored.push(e),this.createElement(e),window.localStorage.setItem("commands",JSON.stringify(this.stored))}load(){const e=window.localStorage.getItem("commands");if(e)try{this.stored=JSON.parse(e),this.stored.map(e=>this.createElement(e))}catch(e){console.error(e)}}clear(){window.localStorage.removeItem("commands"),window.location.reload()}};$("#clearCommands").on("click",()=>Commands.clear()),$("#commandForm").on("submit",e=>{e.preventDefault();const t=new FormData(e.target),o=["name","icon","color","size","style","type","byte1","byte2","byte3"].reduce((e,o)=>(e[o]=t.get(o),e),{});Commands.push(o),$("#commandFormModal").modal("hide")});var curZoom=100;const updateZoom=e=>{curZoom+=20*e,window.localStorage.setItem("zoom",curZoom),$("body").css("zoom",` ${curZoom}%`)},storageZoom=window.localStorage.getItem("zoom");if(storageZoom)try{curZoom=parseInt(storageZoom)}catch(e){window.localStorage.removeItem("zoom")}function getToast(e){const t={title:"Pi Midi Dashboard",text:""};Object.assign(t,e),$(`\n        <div class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-delay="2000">\n            <div class="toast-header">\n                <img src="/static/favicon.png" class="rounded mr-2" alt="...">\n                <strong class="mr-auto">${t.title}</strong>\n                <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n            </div>\n            <div class="toast-body">\n                ${t.text}\n            </div>\n        </div>`).appendTo("body").toast("show")}$("body").css("zoom",` ${curZoom}%`),$("#zoomIn").on("click",()=>updateZoom(1)),$("#zoomOut").on("click",()=>updateZoom(-1)),$("#requestFullScreen").on("click",()=>{var e=window.document,t=e.documentElement,o=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen,a=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?a.call(e):o.call(t)});